# Индикатор Трафоретто для TradingView

## Описание

Индикатор **Traforetto Strategy (Tactica Adversa)** реализует стратегию Трафоретто в Pine Script v6 для платформы TradingView. Стратегия основана на методологии "Tactica Adversa" и позволяет визуализировать модели расширения (МР), рассчитывать Сакральную Точку (СТ), прогнозировать будущие точки с помощью Гексаграммы и генерировать торговые сигналы.

## Основные компоненты

### 1. Модель Расширения (МР)

Модель строится по 4-6 точкам экстремумов:
- **Восходящий тренд**: low1 → high2 → low3 → high4 → low5 → high6
- **Нисходящий тренд**: high1 → low2 → high3 → low4 → high5 → low6

**Визуализация:**
- Сплошная линия: линия тренда (соединяет точки 1-3)
- Пунктирная линия: линия целей (соединяет точки 2-4)
- Метки 1, 2, 3, 4, 5, 6: точки модели

### 2. Сакральная Точка (СТ)

**Расчет:**
- Точка пересечения линии тренда (1-3) и линии целей (2-4)
- Определяется автоматически после формирования 4 точек

**Оценка силы тренда:**
- Сильный тренд: отношение СТ-1 / 1-3 < 0.8 (настраиваемый параметр)
- Слабый тренд: отношение СТ-1 / 1-3 > 0.8

**Визуализация:**
- Фиолетовый крестик в точке пересечения
- Метка с информацией о силе тренда

### 3. Гексаграмма

**Назначение:**
Прогнозирование координат точек 5 и 6 модели расширения.

**Построение:**
1. Находится середина отрезка 3-4
2. Проводится прямая от СТ через середину 3-4
3. Определяется точка C (на продолжении)
4. Точка A (прогноз точки 5): пересечение линий (2 - середина 3-4) и (3 - C)
5. Точка B (прогноз точки 6): пересечение линий (1 - середина 3-4) и (4 - C)

**Визуализация:**
- Пунктирные синие линии Гексаграммы
- Метки "A (прогноз 5)" и "B (прогноз 6)"

### 4. Торговые сигналы

**LONG сигнал (покупка):**
- Восходящий тренд определен
- Тренд сильный (СТ-1 / 1-3 < минимального значения)
- Цена находится в зоне входа от линии тренда (по умолчанию ±5%)
- Минимум 3 точки модели сформированы

**SHORT сигнал (продажа):**
- Нисходящий тренд определен
- Тренд сильный
- Цена находится в зоне входа от линии тренда
- Минимум 3 точки модели сформированы

**Визуализация:**
- Зеленый треугольник вверх: LONG
- Красный треугольник вниз: SHORT
- Подсветка фона при сигнале

## Настройки индикатора

### Основные настройки

| Параметр | Описание | Значение по умолчанию | Диапазон |
|----------|----------|----------------------|----------|
| **Pivot Strength** | Чувствительность определения экстремумов | 5 | 1-20 |

**Рекомендации:**
- Маленькое значение (1-3): больше точек, более чувствительный анализ, подходит для младших таймфреймов
- Среднее значение (4-7): баланс, универсальное применение
- Большое значение (8-20): меньше точек, фильтрация шума, подходит для старших таймфреймов

### Настройки отображения

| Параметр | Описание | По умолчанию |
|----------|----------|--------------|
| **Показать линии тренда** | Отображение линии тренда (1-3) | ✓ |
| **Показать линии целей** | Отображение линии целей (2-4) | ✓ |
| **Показать Сакральную Точку (СТ)** | Отображение СТ и информации о силе тренда | ✓ |
| **Показать Гексаграмму** | Отображение прогнозных построений | ✓ |
| **Показать метки точек** | Отображение меток 1-6 и прогнозов A, B | ✓ |
| **Показать сигналы входа** | Отображение LONG/SHORT сигналов | ✓ |

### Цветовые настройки

| Параметр | Цвет по умолчанию |
|----------|-------------------|
| **Цвет восходящего тренда** | Зеленый |
| **Цвет нисходящего тренда** | Красный |
| **Цвет Сакральной Точки** | Фиолетовый |
| **Цвет Гексаграммы** | Синий |

### Настройки сигналов

| Параметр | Описание | Значение по умолчанию | Диапазон |
|----------|----------|----------------------|----------|
| **Минимальное соотношение силы тренда** | Максимальное значение СТ-1 / 1-3 для сильного тренда | 0.8 | 0.1-2.0 |
| **Зона входа от линии тренда (%)** | Допустимое отклонение цены от линии тренда для сигнала | 5.0 | 0.5-20.0 |

**Рекомендации:**
- Для консервативной торговли: уменьшите зону входа до 2-3%
- Для агрессивной торговли: увеличьте зону до 7-10%

## Информационная панель

В правом верхнем углу отображается таблица с текущим состоянием:

| Поле | Описание |
|------|----------|
| **Тренд** | ВОСХОДЯЩИЙ / НИСХОДЯЩИЙ / НЕТ |
| **Точек модели** | Количество сформированных точек (0-6) |
| **Сила тренда** | Числовое значение соотношения СТ-1 / 1-3 |
| **Тип** | СИЛЬНЫЙ / СЛАБЫЙ |
| **Прогноз точки 5** | Расчетная цена точки 5 по Гексаграмме |
| **Прогноз точки 6** | Расчетная цена точки 6 по Гексаграмме |

## Алерты

Индикатор поддерживает 4 типа алертов:

1. **Traforetto LONG Signal**
   - Срабатывает: при появлении сигнала на покупку
   - Сообщение: "Трафоретто: Сигнал на покупку (LONG). Восходящий тренд, цена у линии тренда."

2. **Traforetto SHORT Signal**
   - Срабатывает: при появлении сигнала на продажу
   - Сообщение: "Трафоретто: Сигнал на продажу (SHORT). Нисходящий тренд, цена у линии тренда."

3. **Traforetto Model Complete (4 points)**
   - Срабатывает: когда модель расширения сформирована (4 точки)
   - Сообщение: "Трафоретто: Модель расширения сформирована (4 точки). Готова к торговле."

4. **Traforetto Model Complete (6 points)**
   - Срабатывает: когда модель завершена (6 точек)
   - Сообщение: "Трафоретто: Модель расширения завершена (6 точек). Возможно начало новой модели."

## Установка в TradingView

### Шаг 1: Копирование кода

1. Откройте файл `indicators/traforetto_strategy.pine`
2. Скопируйте весь код индикатора

### Шаг 2: Создание индикатора

1. Откройте TradingView (https://www.tradingview.com/)
2. Нажмите на кнопку "Pine Editor" внизу экрана
3. Создайте новый индикатор (кнопка "New")
4. Вставьте скопированный код
5. Нажмите "Save" и дайте название индикатору
6. Нажмите "Add to Chart" для добавления на график

### Шаг 3: Настройка

1. Кликните на название индикатора в списке индикаторов на графике
2. Выберите "Settings" (иконка шестеренки)
3. Настройте параметры согласно вашим предпочтениям
4. Нажмите "OK"

## Использование индикатора

### Для начинающих

1. **Начните с наблюдения:**
   - Добавьте индикатор на дневной график (D1)
   - Используйте стандартные настройки
   - Наблюдайте как формируются модели

2. **Изучите компоненты:**
   - Обратите внимание на точки 1-4
   - Найдите Сакральную Точку
   - Посмотрите на прогнозы точек 5 и 6

3. **Дождитесь сигнала:**
   - Наблюдайте за информационной панелью
   - Дождитесь появления "СИЛЬНЫЙ" тренд
   - Следите за появлением треугольника LONG или SHORT

### Для опытных трейдеров

1. **Настройте параметры:**
   - Подберите оптимальный Pivot Strength для вашего таймфрейма
   - Настройте минимальное соотношение силы тренда
   - Определите зону входа

2. **Комбинируйте с другими инструментами:**
   - Используйте объемы для подтверждения
   - Добавьте RSI для проверки перекупленности/перепроданности
   - Используйте уровни поддержки/сопротивления

3. **Управление рисками:**
   - Stop-loss размещайте ниже точки 3 (для LONG) или выше точки 3 (для SHORT)
   - Take-profit ставьте на прогнозных точках A и B
   - Используйте соотношение риск/прибыль не менее 1:2

## Примеры применения

### Пример 1: Восходящий тренд

**Ситуация:**
- Определен восходящий тренд (зеленые линии)
- Сформированы точки 1-4
- СТ показывает "СИЛЬНЫЙ" тренд
- Цена откатила к точке 5

**Действия:**
1. Дождитесь появления сигнала LONG (зеленый треугольник)
2. Входите в покупку при касании линии тренда
3. Stop-loss: ниже точки 5 на 1-2%
4. Take-profit 1: прогноз точки 6 (метка B)
5. Take-profit 2: продолжение линии целей

### Пример 2: Нисходящий тренд

**Ситуация:**
- Определен нисходящий тренд (красные линии)
- Сформированы точки 1-4
- СТ показывает "СИЛЬНЫЙ" тренд
- Цена откатила к точке 5

**Действия:**
1. Дождитесь появления сигнала SHORT (красный треугольник)
2. Входите в продажу при касании линии тренда
3. Stop-loss: выше точки 5 на 1-2%
4. Take-profit 1: прогноз точки 6 (метка B)
5. Take-profit 2: продолжение линии целей

## Рекомендации по таймфреймам

| Таймфрейм | Pivot Strength | Зона входа (%) | Применение |
|-----------|----------------|----------------|------------|
| **M5-M15** | 2-3 | 3-5 | Скальпинг |
| **M30-H1** | 4-5 | 4-6 | Внутридневная торговля |
| **H4-D1** | 5-7 | 5-8 | Свинг-трейдинг |
| **W1** | 8-10 | 7-10 | Долгосрочные инвестиции |

## Ограничения

1. **Ретроспективность:**
   - Точки модели определяются с задержкой (на основе pivot strength)
   - Сигналы могут появляться с запозданием на волатильных рынках

2. **Требуется подтверждение:**
   - Индикатор не гарантирует прибыль
   - Рекомендуется использовать дополнительные инструменты анализа

3. **Не для всех рынков:**
   - Лучше всего работает на трендовых рынках
   - На боковых рынках может давать ложные сигналы

## Часто задаваемые вопросы (FAQ)

**Q: Почему не отображаются линии?**
A: Убедитесь, что сформированы хотя бы 4 точки модели. Проверьте настройку "Pivot Strength" - возможно, нужно уменьшить значение.

**Q: Как понять, что тренд сильный?**
A: Посмотрите на информационную панель. Если в поле "Тип" отображается "СИЛЬНЫЙ", тренд считается сильным.

**Q: Можно ли использовать на криптовалютах?**
A: Да, индикатор универсален и работает на любых инструментах (акции, форекс, криптовалюты, товары).

**Q: Сколько времени нужно для формирования модели?**
A: Зависит от таймфрейма и настроек Pivot Strength. На дневном графике обычно 4-8 недель.

**Q: Что делать, если модель завершена (6 точек)?**
A: После завершения модели индикатор начнет искать новую модель. Можно закрыть позиции или дождаться новых сигналов.

## Дисклеймер

Этот индикатор предоставляется только в образовательных и информационных целях. Он не является финансовым советом. Торговля на финансовых рынках связана с высоким уровнем риска и может привести к потере всего капитала. Всегда используйте надлежащее управление рисками и торгуйте только теми средствами, потерю которых вы можете себе позволить.

---

**Версия:** 1.0
**Дата:** 29 января 2026
**Автор:** TRADERAGENT
**Лицензия:** Mozilla Public License 2.0
