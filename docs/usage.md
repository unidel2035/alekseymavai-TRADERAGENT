# Руководство пользователя

## Обзор системы

Система состоит из трех основных компонентов:

1. **TradingView индикатор** - анализирует рынок и генерирует сигналы
2. **Webhook сервер** - получает сигналы и обрабатывает их
3. **Bybit API** - исполняет торговые приказы на бирже

## Настройка индикатора

### Параметры риск-менеджмента

- **Риск на сделку (%)** - процент от баланса, которым вы рискуете в каждой сделке (рекомендуется 1-2%)
- **Соотношение риск/прибыль** - целевое соотношение потенциальной прибыли к риску (рекомендуется 2:1 или выше)
- **Stop Loss (%)** - процент от цены входа для установки стоп-лосса

### Параметры отображения

- **Показать сигналы покупки** - отображать ли сигналы на покупку на графике
- **Показать сигналы продажи** - отображать ли сигналы на продажу
- **Показать уровни SL/TP** - визуализировать уровни стоп-лосс и тейк-профит

### Настройки алертов

- **Включить алерты** - активировать отправку webhook сигналов
- **Webhook URL** - адрес вашего сервера (настраивается в алерте TradingView)

## Интерпретация сигналов

### Сигналы покупки (BUY)

Генерируются при выполнении следующих условий:
- RSI показывает перепроданность (< 30)
- MACD пересекает сигнальную линию снизу вверх
- Цена находится у нижней границы Bollinger Bands
- Общий тренд восходящий (EMA 50 > EMA 200)

### Сигналы продажи (SELL)

Генерируются при выполнении следующих условий:
- RSI показывает перекупленность (> 70)
- MACD пересекает сигнальную линию сверху вниз
- Цена находится у верхней границы Bollinger Bands
- Общий тренд нисходящий (EMA 50 < EMA 200)

### Информационная панель

В правом верхнем углу графика отображается таблица с текущими показателями:
- **RSI** - текущее значение индикатора относительной силы
- **Тренд** - направление основного тренда
- **MACD** - текущее состояние MACD (бычий/медвежий)
- **BB Squeeze** - наличие сжатия Bollinger Bands (признак будущей волатильности)
- **Последний сигнал** - тип последнего сгенерированного сигнала

## Управление позициями

### Автоматическое управление

При получении сигнала система автоматически:
1. Рассчитывает размер позиции на основе риска
2. Размещает рыночный ордер на вход
3. Устанавливает защитный стоп-лосс
4. Устанавливает целевой тейк-профит

### Ручное управление через API

Вы можете управлять позициями через HTTP endpoints:

#### Просмотр текущих позиций
```bash
curl http://your-server:3000/positions
```

#### Просмотр активных ордеров
```bash
curl http://your-server:3000/orders
```

#### Закрытие всех позиций
```bash
curl -X POST http://your-server:3000/close-all
```

## Мониторинг системы

### Проверка здоровья сервера
```bash
curl http://your-server:3000/health
```

Ответ покажет:
- Статус сервера
- Время работы
- Текущее время

### Просмотр логов

#### Если используете PM2:
```bash
pm2 logs tradingview-webhook
pm2 monit  # Интерактивный мониторинг
```

#### Файлы логов:
- `combined.log` - все события
- `error.log` - только ошибки

### Пример записи в логе успешной сделки:
```json
{
  "level": "info",
  "message": "Trade signal processed",
  "result": {
    "mainOrder": {
      "orderId": "xxx-xxx-xxx",
      "symbol": "BTCUSDT",
      "side": "Buy",
      "qty": 0.001
    },
    "stopLoss": "placed",
    "takeProfit": "placed",
    "positionSize": 0.001
  }
}
```

## Рекомендации по использованию

### Начальная настройка

1. **Начните с тестнета** - используйте тестовую среду Bybit для проверки
2. **Малый риск** - начните с 0.5-1% риска на сделку
3. **Наблюдение** - первые дни внимательно следите за работой системы

### Оптимальные таймфреймы

- **15 минут** - для краткосрочной торговли
- **1 час** - баланс между количеством сигналов и их качеством
- **4 часа** - для среднесрочной торговли с меньшим количеством сигналов

### Фильтрация сигналов

Система автоматически фильтрует сигналы:
- Минимум 10 баров между сигналами
- Проверка на сжатие волатильности
- Подтверждение тренда

### Управление риском

1. **Не увеличивайте риск** во время просадки
2. **Ведите журнал сделок** для анализа эффективности
3. **Регулярно выводите прибыль**
4. **Имейте план на случай технических сбоев**

## Частые вопросы

### Почему не генерируются сигналы?

- Проверьте, что все условия для сигнала выполнены
- Убедитесь, что прошло достаточно времени с последнего сигнала
- Проверьте настройки индикатора

### Как изменить размер позиции?

Размер позиции рассчитывается автоматически на основе:
- Баланса аккаунта
- Процента риска
- Расстояния до стоп-лосса

Измените параметр "Риск на сделку (%)" для корректировки.

### Можно ли торговать несколькими парами?

Да, создайте отдельный алерт для каждой пары. Сервер автоматически обработает сигналы для разных символов.

### Как остановить торговлю?

1. Отключите алерты в TradingView
2. Закройте все позиции через `/close-all` endpoint
3. Остановите webhook сервер

## Обновление системы

### Обновление индикатора

1. Откройте Pine Editor в TradingView
2. Загрузите новую версию кода
3. Сохраните и обновите на графике

### Обновление сервера

```bash
# Остановите сервер
pm2 stop tradingview-webhook

# Обновите код
git pull
npm install

# Перезапустите
pm2 start tradingview-webhook
```

## Поддержка

При возникновении проблем:

1. Проверьте логи сервера
2. Убедитесь в правильности настроек
3. Проверьте статус Bybit API
4. Обратитесь к документации API Bybit

## Отказ от ответственности

Эта система предоставляется как есть. Торговля на финансовых рынках связана с риском потери капитала. Всегда тестируйте стратегию на демо-счете перед использованием реальных средств.